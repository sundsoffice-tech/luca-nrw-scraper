{% extends 'crm/base.html' %}
{% load static %}

{% block title %}Social Media Preview - {{ page.title }}{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <h1 class="h3 mb-0">
                    <i class="fas fa-share-alt me-2"></i>
                    Social Media Preview
                </h1>
                <a href="{% url 'pages:page-builder' page.slug %}" class="btn btn-secondary">
                    <i class="fas fa-arrow-left me-2"></i>
                    Zurück zum Builder
                </a>
            </div>
            <p class="text-muted mt-2">Vorschau, wie Ihre Seite auf verschiedenen Social-Media-Plattformen erscheint</p>
        </div>
    </div>

    <div class="row">
        <!-- Facebook Preview -->
        <div class="col-lg-6 mb-4">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="fab fa-facebook me-2"></i>
                        Facebook / WhatsApp
                    </h5>
                </div>
                <div class="card-body">
                    <div class="social-preview facebook-preview">
                        <div class="preview-header">
                            <div class="preview-user">
                                <div class="preview-avatar"></div>
                                <div>
                                    <div class="preview-name">Ihr Unternehmen</div>
                                    <div class="preview-time">Gerade eben</div>
                                </div>
                            </div>
                        </div>
                        <div class="preview-text">
                            Schau dir das an!
                        </div>
                        <div class="preview-card">
                            {% if og_image %}
                            <div class="preview-image" style="background-image: url('{{ og_image }}')"></div>
                            {% else %}
                            <div class="preview-image preview-no-image">
                                <i class="fas fa-image"></i>
                                <p>Kein Bild vorhanden</p>
                            </div>
                            {% endif %}
                            <div class="preview-content">
                                <div class="preview-url">{{ page_url|truncatechars:40 }}</div>
                                <div class="preview-title">{{ og_title|default:"Kein Titel" }}</div>
                                <div class="preview-description">{{ og_description|truncatechars:150|default:"Keine Beschreibung" }}</div>
                            </div>
                        </div>
                    </div>
                    
                    {% if not og_image or not og_title or not og_description %}
                    <div class="alert alert-warning mt-3 mb-0">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>Optimierung empfohlen:</strong>
                        <ul class="mb-0 mt-2">
                            {% if not og_image %}<li>Fügen Sie ein OpenGraph-Bild hinzu (empfohlen: 1200x630px)</li>{% endif %}
                            {% if not og_title %}<li>Fügen Sie einen OpenGraph-Titel hinzu</li>{% endif %}
                            {% if not og_description %}<li>Fügen Sie eine OpenGraph-Beschreibung hinzu</li>{% endif %}
                        </ul>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Twitter/X Preview -->
        <div class="col-lg-6 mb-4">
            <div class="card shadow-sm">
                <div class="card-header" style="background: #000; color: white;">
                    <h5 class="mb-0">
                        <i class="fab fa-x-twitter me-2"></i>
                        X (Twitter)
                    </h5>
                </div>
                <div class="card-body">
                    <div class="social-preview twitter-preview">
                        <div class="preview-header">
                            <div class="preview-user">
                                <div class="preview-avatar"></div>
                                <div>
                                    <div class="preview-name">Ihr Unternehmen <span class="text-muted">@unternehmen</span></div>
                                    <div class="preview-time">Gerade eben</div>
                                </div>
                            </div>
                        </div>
                        <div class="preview-text">
                            Schau dir das an!
                        </div>
                        <div class="preview-card twitter-card">
                            {% if twitter_image %}
                            <div class="preview-image" style="background-image: url('{{ twitter_image }}')"></div>
                            {% else %}
                            <div class="preview-image preview-no-image">
                                <i class="fas fa-image"></i>
                                <p>Kein Bild vorhanden</p>
                            </div>
                            {% endif %}
                            <div class="preview-content">
                                <div class="preview-url">{{ page_url|truncatechars:40 }}</div>
                                <div class="preview-title">{{ twitter_title|default:"Kein Titel" }}</div>
                                <div class="preview-description">{{ twitter_description|truncatechars:120|default:"Keine Beschreibung" }}</div>
                            </div>
                        </div>
                    </div>
                    
                    {% if not twitter_image or not twitter_title or not twitter_description %}
                    <div class="alert alert-warning mt-3 mb-0">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>Optimierung empfohlen:</strong>
                        <ul class="mb-0 mt-2">
                            {% if not twitter_image %}<li>Fügen Sie ein Twitter Card-Bild hinzu (empfohlen: 1200x628px)</li>{% endif %}
                            {% if not twitter_title %}<li>Fügen Sie einen Twitter Card-Titel hinzu</li>{% endif %}
                            {% if not twitter_description %}<li>Fügen Sie eine Twitter Card-Beschreibung hinzu</li>{% endif %}
                        </ul>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- LinkedIn Preview -->
        <div class="col-lg-6 mb-4">
            <div class="card shadow-sm">
                <div class="card-header" style="background: #0a66c2; color: white;">
                    <h5 class="mb-0">
                        <i class="fab fa-linkedin me-2"></i>
                        LinkedIn
                    </h5>
                </div>
                <div class="card-body">
                    <div class="social-preview linkedin-preview">
                        <div class="preview-header">
                            <div class="preview-user">
                                <div class="preview-avatar"></div>
                                <div>
                                    <div class="preview-name">Ihr Unternehmen</div>
                                    <div class="preview-time">Gerade eben</div>
                                </div>
                            </div>
                        </div>
                        <div class="preview-text">
                            Schau dir das an!
                        </div>
                        <div class="preview-card">
                            {% if og_image %}
                            <div class="preview-image" style="background-image: url('{{ og_image }}')"></div>
                            {% else %}
                            <div class="preview-image preview-no-image">
                                <i class="fas fa-image"></i>
                                <p>Kein Bild vorhanden</p>
                            </div>
                            {% endif %}
                            <div class="preview-content">
                                <div class="preview-title">{{ og_title|default:"Kein Titel" }}</div>
                                <div class="preview-url">{{ page_url|truncatechars:40 }}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SEO Details -->
        <div class="col-lg-6 mb-4">
            <div class="card shadow-sm">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-search me-2"></i>
                        SEO & Meta Tags Details
                    </h5>
                </div>
                <div class="card-body">
                    <table class="table table-sm">
                        <tr>
                            <th>OG Title:</th>
                            <td>{{ og_title|default:"-" }}</td>
                        </tr>
                        <tr>
                            <th>OG Description:</th>
                            <td>{{ og_description|truncatechars:100|default:"-" }}</td>
                        </tr>
                        <tr>
                            <th>OG Image:</th>
                            <td>{% if og_image %}<a href="{{ og_image }}" target="_blank">{{ og_image|truncatechars:40 }}</a>{% else %}-{% endif %}</td>
                        </tr>
                        <tr>
                            <th>OG Type:</th>
                            <td>{{ page.og_type }}</td>
                        </tr>
                        <tr>
                            <th>Twitter Card:</th>
                            <td>{{ page.twitter_card }}</td>
                        </tr>
                        <tr>
                            <th>Share Buttons:</th>
                            <td>
                                {% if page.enable_share_buttons %}
                                    <span class="badge bg-success">Aktiviert</span>
                                    ({{ page.share_button_position }})
                                {% else %}
                                    <span class="badge bg-secondary">Deaktiviert</span>
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <th>Plattformen:</th>
                            <td>{{ page.get_share_platforms|join:", " }}</td>
                        </tr>
                    </table>
                    
                    <div class="mt-3">
                        <h6>Empfehlungen für optimale Social Media Performance:</h6>
                        <ul class="small">
                            <li>OpenGraph-Bild: 1200x630px (Facebook, LinkedIn)</li>
                            <li>Twitter Card-Bild: 1200x628px</li>
                            <li>Titel: 60-90 Zeichen</li>
                            <li>Beschreibung: 150-160 Zeichen</li>
                            <li>Verwenden Sie aussagekräftige, ansprechende Texte</li>
                            <li>Testen Sie verschiedene Bilder und Titel</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .social-preview {
        border: 1px solid #e1e8ed;
        border-radius: 8px;
        background: white;
        padding: 16px;
    }
    
    .preview-header {
        margin-bottom: 12px;
    }
    
    .preview-user {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .preview-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .preview-name {
        font-weight: 600;
        font-size: 15px;
        color: #14171a;
    }
    
    .preview-time {
        font-size: 13px;
        color: #657786;
    }
    
    .preview-text {
        font-size: 14px;
        color: #14171a;
        margin-bottom: 12px;
    }
    
    .preview-card {
        border: 1px solid #e1e8ed;
        border-radius: 8px;
        overflow: hidden;
    }
    
    .preview-image {
        width: 100%;
        height: 250px;
        background-size: cover;
        background-position: center;
        background-color: #f5f8fa;
    }
    
    .preview-no-image {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: #8899a6;
    }
    
    .preview-no-image i {
        font-size: 48px;
        margin-bottom: 8px;
    }
    
    .preview-content {
        padding: 12px;
    }
    
    .preview-url {
        font-size: 12px;
        color: #657786;
        margin-bottom: 4px;
        text-transform: uppercase;
    }
    
    .preview-title {
        font-size: 16px;
        font-weight: 600;
        color: #14171a;
        margin-bottom: 4px;
        line-height: 1.3;
    }
    
    .preview-description {
        font-size: 14px;
        color: #657786;
        line-height: 1.4;
    }
    
    .twitter-preview .preview-card {
        border-radius: 16px;
    }
    
    .linkedin-preview .preview-card {
        border: none;
        box-shadow: 0 0 0 1px #e0dfdc;
    }
</style>
{% endblock %}
